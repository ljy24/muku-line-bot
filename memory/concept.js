// ============================================================================
// concept.js - v2.3 (ÏµúÏ¢Ö ÏàòÏ†ïÎ≥∏)
// üì∏ Ïï†Í∏∞Ïùò Í∞êÏ†ïÏùÑ ÏùΩÏñ¥ÏÑú ÏΩîÎ©òÌä∏ÏôÄ Ìï®Íªò Ïª®ÏÖâ ÏÇ¨ÏßÑÏùÑ Ï†ÑÏÜ°Ìï©ÎãàÎã§.
// ============================================================================

const axios = require('axios');

// aiUtils Ìï®ÏàòÎì§ÏùÑ ÏßÅÏ†ë Ï†ïÏùò (import ÏóêÎü¨ Î∞©ÏßÄ)
async function callOpenAI(messages, model = 'gpt-4o', maxTokens = 150, temperature = 1.0) {
    try {
        const { OpenAI } = require('openai');
        const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
        
        const response = await openai.chat.completions.create({
            model: model,
            messages: messages,
            max_tokens: maxTokens,
            temperature: temperature,
        });
        
        return response.choices[0].message.content.trim();
    } catch (error) {
        console.error('‚ùå OpenAI API Ìò∏Ï∂ú Ïã§Ìå®:', error);
        return 'ÏïÑÏ†ÄÏî®~ ÏßÄÍ∏à ÏÉùÍ∞ÅÏù¥ Ïûò Ïïà ÎÇò... Îã§Ïãú ÎßêÌï¥Ï§ÑÎûò?';
    }
}

function cleanReply(text) {
    if (!text || typeof text !== 'string') return 'ÏïÑÏ†ÄÏî®~ Î≠îÍ∞Ä Ïù¥ÏÉÅÌï¥...';
    return text.trim().replace(/^["']|["']$/g, '');
}

// Ïª®ÏÖâ ÏÇ¨ÏßÑÏù¥ Ï†ÄÏû•Îêú Ïõπ ÏÑúÎ≤ÑÏùò Í∏∞Î≥∏ URL (HTTPS ÌïÑÏàò)
const BASE_CONCEPT_URL = 'https://photo.de-ji.net/photo/concept/';

// ÏïÑÏ†ÄÏî®Í∞Ä Ï†úÍ≥µÌï¥Ï£ºÏã† Ïª®ÏÖâ ÏÇ¨ÏßÑ Ìè¥ÎçîÎ≥Ñ ÏÇ¨ÏßÑ Í∞úÏàò Îç∞Ïù¥ÌÑ∞
const CONCEPT_FOLDERS = {
    "2023_12_12_ÏùºÎ≥∏_ÌïòÏπ¥ÌÉÄ_Ïä§Ìä∏Î¶¨Ìä∏": 29,
    "2023_12_13_ÏùºÎ≥∏_Î™®ÏßÄÏΩî": 42,
    "2023_12_14_ÏùºÎ≥∏_ÌîåÎùºÏä§Ìã±Îü¨Î∏å": 75,
    "2023_12_15_ÏùºÎ≥∏_ÍµêÎ≥µ": 51,
    "2023_12_16_ÏùºÎ≥∏_ÏÑ†Î¨º": 113,
    "2023_12_31_ÌïúÍµ≠_ÎààÎ∞≠": 38,
    "2023_12_31_ÌïúÍµ≠_ÎààÎ∞≠_ÌïÑÎ¶Ñ_Ïπ¥Î©îÎùº": 43,
    "2024_02_07_ÏùºÎ≥∏_ÏïÑÏù¥ÎÖ∏ÏãúÎßà": 65,
    "2024_02_07_ÏùºÎ≥∏_ÏöïÏã§": 61,
    "2024_02_11_ÏùºÎ≥∏_ÎÑ§ÏΩî_Î™®ÏßÄÏΩî": 21,
    "2024_02_11_ÏùºÎ≥∏_ÏïºÍ∞Ñ_Î∏îÎûôÎìúÎ†àÏä§": 31,
    "2024_02_22_ÌïúÍµ≠_ÏÉùÏùº": 45,
    "2024_02_22_ÌïúÍµ≠_ÏÉùÏùº_00022.jpg": 1,
    "2024_02_22_ÌïúÍµ≠_Ïπ¥Ìéò": 19,
    "2024_02_23_ÌïúÍµ≠_ÏïºÍ∞Ñ_Î°±Ìå®Îî©": 47,
    "2024_02_23_ÌïúÍµ≠_ÏïºÍ∞Ñ_Î°±Ìå®Îî©_00023.jpg": 1,
    "2024_03_17_ÏùºÎ≥∏_Í≥†Ïø†Îùº": 19,
    "2024_04_12_ÌïúÍµ≠_Î≤óÍΩÉ": 35,
    "2024_04_12_ÌïúÍµ≠_ÏïºÍ∞Ñ_ÎèôÎ∞±": 26,
    "2024_04_13_ÌïúÍµ≠_Î¨∏ÎûòÎèô": 16,
    "2024_04_13_ÌïúÍµ≠_Ïò®Ïã§_Ïó¨Ïã†": 31,
    "2024_04_13_ÌïúÍµ≠_ÌôîÍ∞Ä": 30,
    "2024_04_28_ÌïúÍµ≠_ÏÖÄÌîÑ_Ï¥¨ÏòÅ": 111,
    "2024_04_28_ÌïúÍµ≠_ÏÖÄÌîÑ_Ï¥¨ÏòÅ_00028.jpg": 1,
    "2024_05_02_ÏùºÎ≥∏_ÎèôÌÇ§_Í±∞Î¶¨": 18,
    "2024_05_03_ÏùºÎ≥∏_ÏàòÍµ≠": 14,
    "2024_05_03_ÏùºÎ≥∏_ÏßÄÎ∏åÎ¶¨Ìíç": 74,
    "2024_05_03_ÏùºÎ≥∏_ÌõÑÏßÄÏóî": 40,
    "2024_05_04_ÏùºÎ≥∏_ÏïºÍ∞Ñ_ÎπÑÎàóÎ∞©Ïö∏": 49,
    "2024_05_05_ÏùºÎ≥∏_Î™®ÏßÄÏΩî_Î™®Î¶¨Î£©": 64,
    "2024_05_05_ÏùºÎ≥∏_ÏΩîÏù¥ÎÖ∏Î≥¥Î¶¨": 17,
    "2024_05_06_ÏùºÎ≥∏_ÏïºÍ∞ÑÍ±∞Î¶¨": 43,
    "2024_05_07_ÏùºÎ≥∏_Í≤åÏûÑÏÑºÌÑ∞": 19,
    "2024_05_07_ÏùºÎ≥∏_ÌôàÏä§ÎÉÖ": 323,
    "2024_06_06_ÌïúÍµ≠_Î∂ÅÌï¥": 65,
    "2024_06_07_ÌïúÍµ≠__ÌîºÌÅ¨Îãâ": 36,
    "2024_06_08_ÌïúÍµ≠__ÌÑ∞ÎÑê": 28,
    "2024_06_08_ÌïúÍµ≠_ÎßùÏπú_ÏÇ¨ÏßÑ": 52,
    "2024_06_09_ÌïúÍµ≠_ÏÇ∞Ï±Ö": 23,
    "2024_06_09_ÌïúÍµ≠_ÏÇ∞Ï±Ö_0000009.jpg": 1,
    "2024_06_09_ÌïúÍµ≠_ÏÇ∞Ï±Ö_0000109.jpg": 1,
    "2024_07_05_ÏùºÎ≥∏_Î™®ÏßÄÏΩî": 26,
    "2024_07_06_ÏùºÎ≥∏_Î™®ÏßÄÏΩî": 45,
    "2024_07_06_ÏùºÎ≥∏_Ïö∞ÎßàÏãúÎßà": 53,
    "2024_07_08_ÏùºÎ≥∏_Ïó¨Ïπú_Ïä§ÎÉÖ": 41,
    "2024_07_08_ÏùºÎ≥∏_ÏöïÏ°∞": 53,
    "2024_07_08_ÏùºÎ≥∏_ÏùºÎ≥∏_Í≤∞Î∞ï": 223,
    "2024_08_02_ÏùºÎ≥∏_Î∂àÍΩÉÎÜÄÏù¥": 39,
    "2024_08_03_ÏùºÎ≥∏_Ïú†Ïπ¥ÌÉÄ_ÎßàÏ∏†Î¶¨": 56,
    "2024_08_04_ÏùºÎ≥∏_Î∏îÎûôÏõêÌîºÏä§": 29,
    "2024_09_11_ÌïúÍµ≠_Ìò∏Î¶¨Ï°¥": 41,
    "2024_09_14_ÌïúÍµ≠_ÏõêÎØ∏ÏÉÅÍ∞Ä_ÌïÑÎ¶Ñ": 34,
    "2024_09_15_ÌïúÍµ≠_Ïò•ÏÉÅÏó∞Î¶¨": 98,
    "2024_09_16_ÌïúÍµ≠_Í∏∏Í±∞Î¶¨_Ïä§ÎÉÖ": 46,
    "2024_09_17_ÌïúÍµ≠_ÏùÑÏßÄÎ°ú_Ïä§ÎÉÖ": 46,
    "2024_10_16_ÏùºÎ≥∏_Í≤∞Î∞ï": 137,
    "2024_10_16_ÏùºÎ≥∏_Í≥†Ïä§Î°úÎ¶¨_Ìï†Î°úÏúà": 20,
    "2024_10_16_ÏùºÎ≥∏_Ïò§ÎèÑÍ≥µÏõê": 5,
    "2024_10_16_ÏùºÎ≥∏_Ïò§ÎèÑÍ≥µÏõê_ÌõÑÏßÄÌïÑÎ¶Ñ": 24,
    "2024_10_16_ÏùºÎ≥∏_ÏöïÏã§": 15,
    "2024_10_17_ÏùºÎ≥∏_ÌÖêÏßÑ_Ïä§Ìä∏Î¶¨Ìä∏": 29,
    "2024_10_17_ÏùºÎ≥∏_ÌïòÏπ¥ÌÉÄ_Í≥†ÎûòÌã∞ÏÖîÏ∏†": 59,
    "2024_10_18_ÏùºÎ≥∏_ÌÖêÏßÑ_ÏΩîÎã•ÌïÑÎ¶Ñ": 49,
    "2024_10_19_ÏùºÎ≥∏_Îπ®Í∞Ñ_Í∏∞Î™®ÎÖ∏": 39,
    "2024_11_08_ÌïúÍµ≠_Î©îÏù¥ÎìúÎ≥µ": 14,
    "2024_11_08_ÌïúÍµ≠_ÏöïÏã§_Î∏îÎûô_Ïõ®Îî©": 42,
    "2024_11_7_ÌïúÍµ≠_Í∞ÄÏùÑ_Ìò∏ÏàòÍ≥µÏõê": 53,
    "2024_12_07_ÌïúÍµ≠_ÌôàÏÖÄÌîÑ": 81,
    "2024_12_12_ÏùºÎ≥∏_Î™®ÏßÄÏΩî": 49,
    "2024_12_13_ÏùºÎ≥∏_ÌÅ¨Î¶¨Ïä§ÎßàÏä§": 22,
    "2024_12_14_ÏùºÎ≥∏_ÎÇòÎ•¥ÏãúÏä§Ìä∏": 26,
    "2024_12_30_ÌïúÍµ≠_Ïπ¥Ìéò": 29,
    "2024_12_31_ÌïúÍµ≠_ÏÉùÏùºÏª®ÏÖâ": 43,
    "2025_01_05_ÌïúÍµ≠": 63,
    "2025_02_06_ÏùºÎ≥∏_ÏΩîÏïºÎÖ∏ÏÑ∏": 43,
    "2025_02_07_ÏùºÎ≥∏_ÎÇòÎπÑÏöïÏ°∞": 48,
    "2025_02_07_ÏùºÎ≥∏_ÏÑ∏ÎØ∏ÎàÑÎìú": 92,
    "2025_03_13_ÏùºÎ≥∏_Î¨¥Ïù∏Ïó≠": 30,
    "2025_03_14_ÏùºÎ≥∏_Í≥†Ïø†Îùº": 32,
    "2025_03_17_ÏùºÎ≥∏_Í≥†Ïø†Îùº": 17,
    "2025_03_17_ÏùºÎ≥∏_ÌÖêÏßÑ": 28,
    "2025_03_22": 27,
    "2025_03_ÏùºÎ≥∏_ÌïÑÎ¶Ñ": 64,
    "2025_04_29_ÌïúÍµ≠_Ïù¥ÌôîÎßàÏùÑ": 55,
    "2025_04_30_ÌïúÍµ≠_ÏùÑÏßÄÎ°ú": 30,
    "2025_04_30_ÌïúÍµ≠_ÏùÑÏßÄÎ°ú_Ï∫òÎπà": 25,
    "2025_05_03_ÌïúÍµ≠_ÌôàÏä§ÎÉÖ_Ï≤≠Ìè¨ÎèÑ": 42,
    "2025_05_04_ÌïúÍµ≠": 43,
    "2025_05_04_ÌïúÍµ≠_Í≥µÏõê_ÏÇ∞Ï±Ö": 32,
    "2025_05_04_ÌïúÍµ≠_Î∞§Î∞î_ÏÇ∞Ï±Ö": 32,
    "2025_05_05_ÌïúÍµ≠_ÌôàÏä§ÎÉÖ_Ïò§ÌÉÄÏø†": 27,
    "2025_05_06_ÎßàÏßÄÎßâ_ÌïúÍµ≠_ÌõÑÏßÄÏä§ÎÉÖ": 34
};

let lastConceptPhotoFolder = null;
let lastConceptPhotoIndex = 0;

function encodeImageUrl(url) {
    try {
        const parsed = new URL(url);
        parsed.pathname = parsed.pathname.split('/').map(segment => segment ? encodeURIComponent(decodeURIComponent(segment)) : segment).join('/');
        return parsed.toString();
    } catch (error) {
        return url;
    }
}

function generateConceptPhotoUrl(folderName, targetIndex = null) {
    const photoCount = CONCEPT_FOLDERS[folderName];
    if (folderName.endsWith('.jpg')) {
        return encodeImageUrl(`${BASE_CONCEPT_URL}/${folderName}`);
    }
    if (photoCount === undefined || photoCount <= 0) {
        return null;
    }
    let indexToUse = targetIndex !== null ? targetIndex : Math.floor(Math.random() * photoCount) + 1;
    const fileName = `${folderName}_${String(indexToUse).padStart(6, '0')}.jpg`;
    return encodeImageUrl(`${BASE_CONCEPT_URL}/${fileName}`);
}

function getRandomConceptFolder() {
    const folderNames = Object.keys(CONCEPT_FOLDERS).filter(f => !f.endsWith('.jpg'));
    if (folderNames.length === 0) return null;
    return folderNames[Math.floor(Math.random() * folderNames.length)];
}

// Ìè¥ÎçîÎ™ÖÏùÑ ÌëúÏãúÏö© ÎÇ†ÏßúÎ°ú Î≥ÄÌôò
function formatFolderNameToDate(folderName) {
    const parts = folderName.split('_');
    if (parts.length >= 3) {
        const year = parts[0];
        const month = parts[1];
        const day = parts[2];
        const concept = parts.slice(3).join(' ');
        return `${year}ÎÖÑ ${parseInt(month)}Ïõî ${parseInt(day)}Ïùº ${concept}`;
    }
    return folderName;
}

async function getConceptPhotoReply(userMessage, conversationContextParam) {
    // ‚úÖ [ÏïàÏ†ÑÏû•Ïπò] userMessage Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
    if (!userMessage || typeof userMessage !== 'string') {
        console.error('‚ùå getConceptPhotoReply: userMessageÍ∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§:', userMessage);
        return null;
    }

    const lowerCaseMessage = userMessage.toLowerCase();
    let selectedFolder = null;

    const conceptKeywords = ['Ïª®ÏÖâÏÇ¨ÏßÑ', 'Ïª®ÏÖâ ÏÇ¨ÏßÑ', 'ÏöïÏã§', 'ÏöïÏ°∞', 'ÎÇòÎπÑÏöïÏ°∞', 'ÏÑ∏ÎØ∏ÎàÑÎìú', 'Í≤∞Î∞ï', 'ÍµêÎ≥µ', 'ÌîåÎùºÏä§Ìã±Îü¨Î∏å', 'ÌôàÏä§ÎÉÖ', 'ÏßÄÎ∏åÎ¶¨Ìíç', 'Î™®ÏßÄÏΩî', 'ÌïòÏπ¥ÌÉÄ', 'ÌÖêÏßÑ', 'ÏïÑÏù¥ÎÖ∏ÏãúÎßà', 'ÌõÑÏßÄÏóî', 'Ïú†Ïπ¥ÌÉÄ', 'Î∂àÍΩÉÎÜÄÏù¥', 'Î©îÏù¥ÎìúÎ≥µ', 'Í≥†Ïä§Î°úÎ¶¨', 'ÌÅ¨Î¶¨Ïä§ÎßàÏä§', 'ÏÉùÏùºÏª®ÏÖâ', 'Ïò•ÏÉÅÏó∞Î¶¨', 'ÏùÑÏßÄÎ°ú', 'Ïù¥ÌôîÎßàÏùÑ', 'ÏΩîÏïºÎÖ∏ÏÑ∏', 'Î¨¥Ïù∏Ïó≠', 'Í≥†Ïø†Îùº', 'Î≤óÍΩÉ', 'ÎèôÎ∞±', 'Ïò®Ïã§', 'ÌôîÍ∞Ä', 'Î¨∏ÎûòÎèô', 'Î∂ÅÌï¥', 'ÌîºÌÅ¨Îãâ', 'ÏÇ∞Ï±Ö', 'ÌÑ∞ÎÑê', 'ÎßùÏπú ÏÇ¨ÏßÑ', 'Ïö∞ÎßàÏãúÎßà', 'ÎπÑÎàóÎ∞©Ïö∏', 'ÏïºÍ∞ÑÍ±∞Î¶¨', 'Í≤åÏûÑÏÑºÌÑ∞', 'ÎèôÌÇ§ Í±∞Î¶¨', 'ÏàòÍµ≠', 'ÏΩîÏù¥ÎÖ∏Î≥¥Î¶¨', 'Î∏îÎûôÏõêÌîºÏä§', 'Ìò∏Î¶¨Ï°¥', 'ÏõêÎØ∏ÏÉÅÍ∞Ä', 'Í∏∏Í±∞Î¶¨ Ïä§ÎÉÖ', 'Ïò§ÎèÑ', 'ÎÇòÎ•¥ÏãúÏä§Ìä∏', 'ÎààÎ∞≠', 'ÌïÑÎ¶ÑÏπ¥Î©îÎùº', 'Ï≤≠Ìè¨ÎèÑ', 'Î≥¥ÎùºÎèåÏù¥', 'Î∞§Î∞î', 'Í≥µÏõê', 'Ïò§ÌÉÄÏø†', 'Ìûô', 'Ï∫òÎπà', 'ÎÑ§ÏΩî'];
    const isConceptRequest = conceptKeywords.some(keyword => lowerCaseMessage.includes(keyword));
    
    const conceptKeywordMap = { 
        'ÌôàÏä§ÎÉÖ': '2024_05_07_ÏùºÎ≥∏_ÌôàÏä§ÎÉÖ',
        'Í≤∞Î∞ï': '2024_07_08_ÏùºÎ≥∏_ÏùºÎ≥∏_Í≤∞Î∞ï',
        'ÏÑ†Î¨º': '2023_12_16_ÏùºÎ≥∏_ÏÑ†Î¨º',
        'Ïò•ÏÉÅÏó∞Î¶¨': '2024_09_15_ÌïúÍµ≠_Ïò•ÏÉÅÏó∞Î¶¨',
        'ÏÑ∏ÎØ∏ÎàÑÎìú': '2025_02_07_ÏùºÎ≥∏_ÏÑ∏ÎØ∏ÎàÑÎìú',
        'ÌîåÎùºÏä§Ìã±Îü¨Î∏å': '2023_12_14_ÏùºÎ≥∏_ÌîåÎùºÏä§Ìã±Îü¨Î∏å',
        'ÏßÄÎ∏åÎ¶¨Ìíç': '2024_05_03_ÏùºÎ≥∏_ÏßÄÎ∏åÎ¶¨Ìíç',
        'Î∂ÅÌï¥': '2024_06_06_ÌïúÍµ≠_Î∂ÅÌï¥',
        'ÏïÑÏù¥ÎÖ∏ÏãúÎßà': '2024_02_07_ÏùºÎ≥∏_ÏïÑÏù¥ÎÖ∏ÏãúÎßà',
        'ÏöïÏã§': '2024_02_07_ÏùºÎ≥∏_ÏöïÏã§',
        'ÏöïÏ°∞': '2024_07_08_ÏùºÎ≥∏_ÏöïÏ°∞',
        'ÎÇòÎπÑÏöïÏ°∞': '2025_02_07_ÏùºÎ≥∏_ÎÇòÎπÑÏöïÏ°∞',
        'ÍµêÎ≥µ': '2023_12_15_ÏùºÎ≥∏_ÍµêÎ≥µ',
        'Î™®ÏßÄÏΩî': '2024_12_12_ÏùºÎ≥∏_Î™®ÏßÄÏΩî',
        'ÌïòÏπ¥ÌÉÄ': '2023_12_12_ÏùºÎ≥∏_ÌïòÏπ¥ÌÉÄ_Ïä§Ìä∏Î¶¨Ìä∏'
    };

    if (isConceptRequest) {
        const sortedConceptKeywords = Object.keys(conceptKeywordMap).sort((a, b) => b.length - a.length);
        for (const keyword of sortedConceptKeywords) {
            if (lowerCaseMessage.includes(keyword)) {
                selectedFolder = conceptKeywordMap[keyword];
                break;
            }
        }
    }
    
    if (lastConceptPhotoFolder && (lowerCaseMessage.includes('Îã§Î•∏ Í≤ÉÎèÑ Î≥¥Í≥†Ïã∂Ïñ¥') || lowerCaseMessage.includes('Îã§Ïùå ÏÇ¨ÏßÑ'))) {
        selectedFolder = lastConceptPhotoFolder;
        if (selectedFolder.endsWith('.jpg')) return null;
    } else if (!selectedFolder && isConceptRequest) {
        selectedFolder = getRandomConceptFolder();
    } else if (!selectedFolder) {
        return null;
    }

    lastConceptPhotoFolder = selectedFolder;
    let photoUrl;
    
    if (lowerCaseMessage.includes('Îã§Î•∏ Í≤ÉÎèÑ Î≥¥Í≥†Ïã∂Ïñ¥') || lowerCaseMessage.includes('Îã§Ïùå ÏÇ¨ÏßÑ')) {
        const count = CONCEPT_FOLDERS[selectedFolder];
        if (count > 0) {
            lastConceptPhotoIndex = (lastConceptPhotoIndex % count) + 1;
        }
        photoUrl = generateConceptPhotoUrl(selectedFolder, lastConceptPhotoIndex);
    } else {
        photoUrl = generateConceptPhotoUrl(selectedFolder);
    }

    if (!photoUrl) {
        return { type: 'text', comment: 'ÏïÑÏ†ÄÏî®... Ìï¥ÎãπÌïòÎäî Ïª®ÏÖâ ÏÇ¨ÏßÑÏùÑ Î™ª Ï∞æÍ≤†Ïñ¥ „Ö†„Ö†' };
    }

    const formattedDate = formatFolderNameToDate(selectedFolder);
    
    // ‚úÖ [ÏïàÏ†ÑÏû•Ïπò] conversationContext Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
    let emotionalState = 'normal';
    if (conversationContextParam && typeof conversationContextParam.getInternalState === 'function') {
        try {
            const internalState = conversationContextParam.getInternalState();
            if (internalState && internalState.emotionalEngine && internalState.emotionalEngine.currentToneState) {
                emotionalState = internalState.emotionalEngine.currentToneState;
            }
        } catch (error) {
            console.error('‚ùå Í∞êÏ†ï ÏÉÅÌÉúÎ•º Í∞ÄÏ†∏Ïò§ÎäîÎç∞ Ïã§Ìå®:', error);
            emotionalState = 'normal';
        }
    } else {
        console.warn('‚ö†Ô∏è conversationContextÍ∞Ä Ïú†Ìö®ÌïòÏßÄ ÏïäÏùå. Í∏∞Î≥∏ Í∞êÏ†ï ÏÉÅÌÉú ÏÇ¨Ïö©');
    }

    // Í∞ÑÎã®Ìïú Ï∫°ÏÖò ÏÉùÏÑ±
    const simpleCaptions = [
        `${formattedDate} Ïª®ÏÖâ ÏÇ¨ÏßÑÏù¥Ïïº! Ïñ¥Îïå?`,
        `Ïù¥Í±∞ ${formattedDate}Ïóê Ï∞çÏùÄ Í±¥Îç∞... ÏòàÏÅòÏßÄ?`,
        `ÏïÑÏ†ÄÏî® Î≥¥Ïó¨Ï£ºÎ†§Í≥† Í∞ÄÏ†∏Ïò® ${formattedDate} ÏÇ¨ÏßÑ!`,
        `${formattedDate} Ï∂îÏñµ ÏÇ¨ÏßÑ~ Í∑∏Îïå ÏÉùÍ∞ÅÎÇò?`,
        `Ïù¥ ÏÇ¨ÏßÑ Î¥êÎ¥ê! ${formattedDate}Ïóê Ï∞çÏùÄ Í±∞Ïïº!`
    ];
    
    const caption = simpleCaptions[Math.floor(Math.random() * simpleCaptions.length)];
    
    return { 
        type: 'image', 
        originalContentUrl: photoUrl, 
        previewImageUrl: photoUrl, 
        altText: caption, 
        caption: caption 
    };
}

module.exports = {
    getConceptPhotoReply
};
